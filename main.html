<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily reward</title>
    <style>
        @font-face {
            font-family: 'Cera Pro Bold';
            src: url('CeraPro-Bold.eot');
            src: url('CeraPro-Bold.eot?#iefix') format('embedded-opentype'),
            url('CeraPro-Bold.woff') format('woff'),
            url('CeraPro-Bold.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            }
        body{
            margin: 0;
            padding: 0;
        }
        #background {
            position: absolute;
            top: 0;
            left:0;
            background-color: black;
            z-index: 0;
            width: 100%;
            height: 100%;
        }
        #background-smooth-coin{
            position: relative;
            top: -150px;
            left: 120px;
            filter: blur(85px) brightness(160%);
            width: 250px;
            height:250px;
        }
        #background-big-coin{
            position: relative;
            top: -360px;
            left: -100px;
            filter: blur(4px) brightness(110%);
            transform: rotate(30deg);
            width: 280px;
            height:280px;
        }
        #background-small-coin{
            position: relative;
            top: -500px;
            left: 345px;
            filter: blur(0.5px) brightness(110%);
            transform: rotate(240deg);
            width: 50px;
            height:50px;
        }
        #big-coin{
            position: relative;
            top: -470px;
            filter: blur(1px) brightness(120%);
            width: 130px;
            height:130px;
        }
        #layout{
            position: absolute;
            font-family: 'Cera Pro Bold';
            z-index:445;
        }
        #layout-text p{
            position: absolute;
            font-size: 38px;
            color:white;
            width: 100vw;
            text-align: center;
            margin-bottom: 5px;
        }
        #layout-text a{
            position: absolute;
            top: 200px;
            display: flex;
            justify-content: center;
            width:100vw;
        }
        #layout-text a p {
            color:#626574; 
            width:305px;
            font-size:14px;
        }
        #layout-onlive-days p{
            position: absolute;
            font-size: 22px;
            color:white;
            width: 100vw;
            text-align: center;
            margin-bottom: 5px;
        }
        
        #layout-onlive-days-hint{
            position: absolute;
            width: 70px;
            height: 70px;
            left: 200px;
            top: 330px;
            background: #5C52A0;
            opacity: 0.4;
            filter: blur(25.5px);

        }
        #onlive-days-count{
            position: relative;
            font-size: 38px;
            color: transparent;    
            -webkit-background-clip: text;
            background-clip: text;
            opacity: 1;
            filter: blur(0px);
            background-image: linear-gradient(225deg, #836DC9, #524C95)
        }
        #layout-button{
            display: flex;
            justify-content: center;
            width:100vw; 
            transition: transform 0.2s;
        }
        #layout-button:active {
            position: absolute;
            transform: scale(0.9) translate(0px, 55px); 
        }

        #layout-button #div {
            border-radius: 15px;
            position: absolute;
            top: 442px;
            width: 254px;
            height: 114px;
            margin: 30px;
            background-color: #4F3C2C;
        }
        #layout-button #div::before{
            width: 260px;
            height: 120px;
            content: "";
            position: absolute;
            top: -3px;
            left: -3px;
            background: linear-gradient(225deg, #A0550A 0%, #DAC480 38%, #4B2605 73%, #D3B454 89%, #703105 100%);;
            border-radius: 19px;
            z-index: -1;
        }
        #div2{
            border-radius: 15px;
            position: absolute;
            width: 254px;
            height: 114px;
            background-color: black;
            opacity: 0.5;
        }
        #button-underground-shadow {
            border-radius: 15px;
            position: absolute;
            width: 245px;
            height: 112px;
            background-color: #AE6000;
            opacity: 0.5;
            top: 472px;
            filter: blur(50px)
        }
        #div a{
            color: white;
            z-index: 9999999;
            width: 100%;
            font-size: 32px;
            top: 10px;
            text-align: center;
            position: absolute;
        }
        #div p{
            z-index: 9999999;
            width: 100%;
            font-size: 32px;
            top: 28px;
            left:26px;
            text-align: center;
            position: absolute;
            color: transparent;    
            -webkit-background-clip: text;
            background-clip: text;
            opacity: 1;
            filter: blur(0px);
            background-image: linear-gradient(225deg, #D79A03, #BD6F00)
        }
        #div img{
            position: absolute;
            filter: blur(0px);
            width: 35px;
            z-index: 9999999;
            height: 35px;
            top: 65px;
            left:80px;
            opacity: 1;
        }
        #footer-menu{
            font-family: 'Cera Pro Bold';
            font-size: 14px;
            display: flex;
            position: fixed;
            top:620px;
            justify-content: center;
            width:100vw; 
        }
        #menu{
            width: 95%;
            height: 110px;
            background-color: #2F3037;
            border-radius: 30px;
            filter: opacity(70%);
            color:#70727A;
            display: flex;
        }
        .menu-item{
            position: relative;
            width:100px;
            margin-right: 0px;
        }
        .menu-item img{
            position: absolute;
            top: 10px;
            height: 50px;
            filter: saturate(0%) opacity(80%);
            left:-5px;
        }
        .menu-item p{
            position: absolute;
            width:98%;
            text-align: center;
            top:50px;
            left:-5px;
        }
        .hidden {
            display: none;
        }
        .content-tasks{
            display: flex;
            justify-content: center;
        }


        /* styling tasks button*/
        .layout-button-tasks{
            display: flex;
            justify-content: center;
            width:100vw; 
            transition: transform 0.2s;
        }
        .layout-button-tasks:active {
            position: absolute;
            transform: scale(0.9) translate(0px, 48px); 
        }
        .div-tasks a{
            color: white;
            z-index: 9999999;
            width: 100%;
            font-size: 18px;
            top: 16px;
            text-align: center;
            position: absolute;
        }

        .layout-button-tasks .div-tasks {
            border-radius: 15px;
            position: absolute;
            width: 354px;
            height: 52px;
            margin: 30px;
            background-color: #4F5467;
        }
        .layout-button-tasks .div-tasks::before{
            width: 360px;
            height: 58px;
            content: "";
            position: absolute;
            background: linear-gradient(225deg, #7865BD 0%, #524C95 100%);;
            top: -3px;
            left: -3px;
            border-radius: 19px;
            z-index: -1;
        }
        .div-tasks img{
            display: none;
            position: absolute;
            top:4px;
            left: 282px;
            height: 46px;;
        }
        .div-tasks.completed{
            background-color: #4F3C2C;
        }
        .div-tasks.completed::before {
            background: linear-gradient(225deg, #A0550A 0%, #DAC480 38%, #4B2605 73%, #D3B454 89%, #703105 100%);;
        }
        .div-tasks.completed img{
            display: block;
        }

        .div2-tasks{
            border-radius: 15px;
            position: absolute;
            width: 354px;
            height: 52px;
            background-color: black;
            opacity: 0.5;
        }
        .button-underground-shadow {
            border-radius: 15px;
            position: absolute;
            width: 245px;
            background-color: #AE6000;
            opacity: 0.5;
            height:54px;
            filter: blur(40px); 
            width: 364px
        }
    </style>
</head>
<body>
    <div id="dailyRewardScreen">
        <div id="background">
            <img id="background-smooth-coin" src="ENG-coin.png">
            <br>
            <img src="ENG-coin.png" alt="" id="background-big-coin">
            <br>
            <img src="ENG-coin.png" alt="" id="background-small-coin">
        </div>
        <div id="layout">
            <div id="layout-text">
                <p style="top: 75px;">Ежедневная</p>
                <p style="top: 120px;">награда</p>
                <a style="">
                    <p style="">
                        Забирай монеты за ежедневный вход <br>в игру без пропусков! Кнопку «Забрать» нужно нажимать ежедневно, иначе счетчик дней начнется заново! С каждым днем награда будет расти!
                    </p>
                </a>
            </div>
            <div id="layout-onlive-days">
                <div id="layout-onlive-days-hint"></div>
                <p style="top: 315px;">Подряд уже  <a id="onlive-days-count">25</a>  дней</p>
                <p style="top: 375px;">Так держать!</p>
            </div>
            <div id="layout-button" onclick="claimDailyReward()">
                <div id="div">
                    <div id="div2">
                        <div id="background-button">
                        </div>
                    </div>
                    <a>Забрать</a>
                    <img src="ENG-coin.png" alt="" id="btn-coin">
                    <p>+50</p>
                </div>
                <div id="button-underground-shadow"></div>
            </div>
        </div>
    
        <div id="footer-menu">
            <div id="menu">
                <div id="tests-btn" class="menu-item" onclick="changeMenu('tests')">
                    <img src="tests.png" alt="" style="filter:saturate(0%) brightness(110%) ;" id="tests-img">
                    <p>Тесты</p>
                </div>
                <div id="tasks-btn" class="menu-item" onclick="changeMenu('tasks')">
                    <img src="tasks.png" alt="" id="tasks-img">
                    <p>Задания</p>
                </div>
                <div id="leaderboard-btn" class="menu-item" onclick="changeMenu('leaderboard')">
                    <img src="leaderboard.png" alt="" id="leaderboard-img">
                    <p>Таблица лидеров</p>
                </div>
                <div id="friends-btn" class="menu-item" onclick="changeMenu('friends')">
                    <img src="friends.png" alt="" id="friends-img">
                    <p>Друзья</p>
                </div>
                <div id="building-btn" class="menu-item" onclick="changeMenu('building')">
                    <img src="building.png" alt="" id="building-img">
                    <p>Постройка школы</p>
                </div>
            </div>
        </div>
    </div>
    <div id="tasks" class="hidden">
        <div id="background">
            <img id="background-smooth-coin" src="ENG-coin.png">
            <br>
            <img src="ENG-coin.png" alt="" id="background-big-coin">
            <br>
            <img src="ENG-coin.png" alt="" id="background-small-coin">
            <br>
            <div class="content-tasks">
                <img src="ENG-coin.png" alt="" id="big-coin">
            </div>
            
        </div>
        <div id="layout">
            <div id="layout-text">
                <p style="top: 230px; font-size:26px">Получи больше монет</p>
            </div>
            <div class="layout-button-tasks" style="">
                <div class="div-tasks" style="top: 292px;" id="task-daily" onclick="changeMenu('dailyRewardScreen')">
                    <div class="div2-tasks">
                        <div class="background-button">
                        </div>
                    </div>
                    <a>Ежедневный вход</a>
                    <img src="completed.png" alt="">
                </div>
            </div>
            <div class="layout-button-tasks">
                <div class="div-tasks" style="top: 362px;" onclick="changeMenu('telegram')" id="task-channel">
                    <div class="div2-tasks">
                        <div class="background-button">
                        </div>
                    </div>
                    <a style="top:4px">Присоеденяйся к нашему<br>телеграм каналу</a>
                    <img src="completed.png" alt="">
                </div>
            </div>
            <div class="layout-button-tasks" style="">
                <div class="div-tasks" style="top: 432px;" id="task-friends" onclick="changeMenu('friends')">
                    <div class="div2-tasks">
                        <div class="background-button">
                        </div>
                    </div>
                    <a>Пригласи 3-х друзей</a>
                    <img src="completed.png" alt="">
                </div>
            </div>
            
        </div>
        <div id="footer-menu">
            <div id="menu">
                <div id="tests-btn" class="menu-item" onclick="changeMenu('tests')">
                    <img src="tests.png" alt="" style="filter:saturate(0%) brightness(110%) ;" id="tests-img">
                    <p>Тесты</p>
                </div>
                <div id="tasks-btn" class="menu-item" onclick="changeMenu('tasks')">
                    <div class="active-menu-element" style="background-color: #1a1c21; border-radius:10px; border-color:#2F3037; position: absolute; width: 100%; height: 98px; left:-6px; top: 5px"></div>
                    <img src="tasks.png" alt="" id="tasks-img" style="filter:saturate(100%);">
                    <p>Задания</p>
                </div>
                <div id="leaderboard-btn" class="menu-item" onclick="changeMenu('leaderboard')">
                    <img src="leaderboard.png" alt="" id="leaderboard-img">
                    <p>Таблица лидеров</p>
                </div>
                <div id="friends-btn" class="menu-item" onclick="changeMenu('friends')">
                    <img src="friends.png" alt="" id="friends-img">
                    <p>Друзья</p>
                </div>
                <div id="building-btn" class="menu-item" onclick="changeMenu('building')">
                    <img src="building.png" alt="" id="building-img">
                    <p>Постройка школы</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        let server_ip = "https://45.82.153.57"
        let tg = window.Telegram.WebApp;
        tg.expand()
        let screens_id = ["dailyRewardScreen", "tasks"]
        function changeMenu(new_screen) {
            let screen = document.getElementById(new_screen)
            document.getElementsByClassName("hidden")[0].classList.remove("hidden")
            screens_id.forEach((id) => {
                if (id == new_screen) {
                    if (screen.classList.contains("hidden")) {
                        screen.classList.remove("hidden")
                    }
                } else{
                    document.getElementById(id).classList.add("hidden")
                }
            });
            if (new_screen == "tasks") {
                let body = JSON.stringify({"id": tg.initDataUnsafe.user.id})
                let xhr = new XMLHttpRequest()
                xhr.open("POST", server_ip+'/getCompletedTasks')
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onreadystatechange = function() {
                    if (this.readyState != 4) alert("error");
                    let data = JSON.parse(this.response)
                    data["completed"].forEach((id) => {
                        document.getElementById(id).classList.add("completed")
                    })
                  }
                xhr.send(body)
                
            }
            if (new_screen == "dailyRewardScreen") {
                let body = JSON.stringify({"id": tg.initDataUnsafe.user.id})
                let xhr = new XMLHttpRequest()
                xhr.open("POST", server_ip+'/getDailyCount')
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onreadystatechange = function() {
                    if (this.readyState != 4) alert("error");
                    let data = JSON.parse(this.response)
                    document.getElementById('onlive-days-count').textContent = data["days"]
                  }
                xhr.send(body)
            }
        }
        function claimDailyReward() {
            try {
                let body = JSON.stringify({"id": tg.initDataUnsafe.user.id})
                let xhr = new XMLHttpRequest()
                xhr.open("POST", server_ip+'/claimDailyReward')
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onreadystatechange = function() {
                    if(http.readyState == 4 && http.status == 200) {
                        document.getElementById("div").innerHTML = "<div id='div2'><div id='background-button'></div></div><a style='top: 30px'>Успешено!</a>"
                        changeMenu("tests")
                    }
                }
                alert(server_ip+'/claimDailyReward')
                xhr.send(body)
                alert(xhr.readyState)
            } catch(error) {
                alert(error)
            }
        }
        function goToChannel() {

        }
    </script>
</body>
</html>